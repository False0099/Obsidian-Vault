## 概念
我们把计算机网络的各层及其协议的集合称为网络的**体系结构**(Architecture)。换言之，计算机网络的体系结构就是这个计算机网络及其所应完成的功能的精确定义，它是计算机网络中的层次、各层的协议及层间接口的集合。需要强调的是，这些功能究竟是用何种硬件或软件完成的则是一个遵循这种体系结构的实现(Implementation)问题。体系结构是抽象的，而实现是具体的，是真正在运行的计算机硬件和软件。

在计算机网络体系结构的各个层次中，每个报文都分为两部分：一是数据部分，即 SDU; 二是控制信息部分，即 PCI, 它们共同组成 PDU。
服务数据单元 (SDU): 为完成用户所要求的功能而应传送的数据。第 $n$ 层的服务数据单元记为 $n\textbf{- SDU}.$
协议控制信息 (PCI): 控制协议操作的信息。第 $n$ 层的协议控制信息记为 $n$ -PCI。
协议数据单元 (PDU): 对等层次之间传送的数据单位称为该层的 PDU。第 $n$ 层的协议数据单元记为 $n$ -PDU。

在实际的网络中，每层的协议数据单元都有一个通俗的名称，如物理层的 PDU 称为比特，数据链路层的 PDU 称为帧，网络层的 PDU 称为分组，传输层的 PDU 称为报文段。

![[Pasted image 20240702191751.png]]


## 协议，接口，服务
### 协议
协议，就是规则的集合。在网络中要做到有条不紊地交换数据，**就必须遵循一些事先约定好的规则**。这些规则明确规定了所交换的数据的格式及有关的同步问题。这些为进行网络中的数据交换而建立的规则、标准或约定称为网络协议 (Network Protocol),

它是控制两个 (或多个)对等实体进行通信的规则的集合，是水平的。不对等实体之间是没有协议的，比如用 TCP/IP 协议栈通信的两个结点，结点 A 的传输层和结点 B 的传输层之间存在协议，但结点 A 的传输层和结点 B 的网络层之间不存在协议。网络协议也简称为协议。

协议由语法、语义和同步三部分组成。语法规定了**传输数据的格式**；语义规定了所要**完成的功能**，即需要发出何种控制信息、完成何种动作及做出何种应答；同步规定了**执行各种操作的条件、时序关系**等，即事件实现顺序的详细说明。一个完整的协议通常应具有线路管理 (建立、释放连接)、差错控制、数据转换等功能。

### 接口：
接口是同一结点内相邻两层间交换信息的连接点，是一个系统内部的规定。每层只能为**紧邻的层次之间定义接口**，不能跨层定义接口。在典型的接口上，同一结点相邻两层的实体通过**服务访问点**(Service Access Point,SAP)进行交互。服务是通过 SAP 提供给上层使用的，第 $n$ 层的 SAP 就是第 $n+1$ 层可以访问第 $n$ 层服务的地方。每个 SAP 都有一个能够标识它的地址。SAP 是一个抽象的概念，它实际上是一个逻辑接口(类似于邮政信箱),但和通常所说的两个设备之间的硬件接口是很不一样的。

### 服务：
它是垂直的。对等实体在协议的控制下，使得服务是指下层为紧邻的上层提供的功能调用，本层能为上一层提供服务，但要实现本层协议还需要使用下一层所提供的服务。
![[Pasted image 20240702192140.png]]

我们可以根据我们的条件将我们的服务分为下面的几类：

1. 面向连接服务与无连接服务
在面向连接服务中，通信前**双方必须先建立连接**，分配相应的资源 (如缓冲区), 以保证通信能正常进行，传输结束后释放连接和所占用的资源。因此这种服务可以分为连接建立、数据传输和连接释放三个阶段。例如 TCP 就是一种面向连接服务的协议。
在无连接服务中，通信前双方**不需要先建立连接**，需要发送数据时可直接发送，把每个带有目的地址的包 (报文分组)传送到线路上，由系统选定路线进行传输。这是一种不可靠的服务。这种服务常被描述为“尽最大努力交付”(Best-Effort-Delivery), 它并不保证通信的可靠性。例如 IP、UDP 就是一种无连接服务的协议。

2. 可靠服务与不可靠服务：
可靠服务是指网络具有**纠错、检错、应答**机制，能保证数据正确、可靠地传送到目的地。

不可靠服务是指网络只是尽量正确、可靠地传送，而不能保证数据正确、可靠地传送到目的地，是一种尽力而为的服务。

对于提供不可靠服务的网络，其网络的正确性、可靠性要由应用或用户来保障。例如，用户收到信息后要判断信息的正确性，如果不正确，那么用户要把出错信息报告给信息的发送者，以便发送者采取纠正措施。通过用户的这些措施，可以把不可靠的服务变成可靠的服务。

## OSI 模型
国际标准化组织(ISO)提出的网络体系结构模型，称为开放系统互连参考模型(OSI/RM) 通常简称为 OSI 参考模型。OSI 参考模型有 7层，自下而上依次为物理层、数据链路层、网络层传输层、会话层、表示层、应用层。低三层统称为通信子网，它是为了联网而附加的通信设备，完成数据的传输功能；高三层统称为资源子网，它相当于计算机系统，完成数据的处理等功能。传输层承上启下。OSI 参考模型的层次结构如图 1.8 所示。
![[Pasted image 20240702192916.png]]

（1）物理层：
物理层的传输单位是比特，任务是透明的传输比特流，功能是在物理媒体上为数据端设备透明地传输原始比特流。

物理层主要定义数据**终端设备 (DTE)和数据通信设备 (DCE)的物理与逻辑连接方法**，所以物理层协议也称物理层接口标准。由于在通信技术的早期阶段，通信规则称为规程 (Procedure), 因此物理层协议也称物理层规程。

（2）数据链路层：
数据链路层的传输单位是帧，任务是将网络层传来的 IP 数据报组装成帧。数据链路层的功能可以概括为成帧、差错控制、流量控制和传输管理等。

（3）网络层：
网络层的传输单位是数据报，它关心的是通信子网的运行控制，主要任务是把网络层的协议数据单元(分组)从源端传到目的端，为分组交换网上的不同主机提供通信服务。关键问题是对分组进行路由选择，并实现流量控制、拥塞控制、差错控制和网际互联等功能。

（4）传输层：
传输层也称运输层，传输单位是报文段(TCP)或用户数据报(UDP),传输层负责**主机中两个进程之间的通信**，功能是为端到端连接提供可靠的传输服务，为端到端连接提供**流量控制**、差错控制、服务质量、数据传输管理等服务。

（5）：会话层：
会话层允许**不同主机上的各个进程之间进行会话**。会话层利用传输层提供的端到端的服务，向表示层提供它的增值服务。这种服务主要为表示层实体或用户进程**建立连接**并在连接上有序地传输数据，这就是会话，也称建立同步 (SYN)。

（6）表示层：
表示层主要处理在两个通信系统中**交换信息的表示方式**。不同机器采用的编码和表示方法不同，使用的数据结构也不同。为了使不同表示方法的数据和信息之间能互相交换，

（7）应用层：
应用层是 OSI 参考模型的最高层，是**用户与网络的界面**。应用层为特定类型的网络应用提供访问 OSI 参考模型环境的手段。因为用户的实际应用多种多样，这就要求应用层采用不同的应用协议来解决不同类型的应用要求，因此应用层是最复杂的一层，使用的协议也最多。典型的协议有用于文件传送的 FTP、用于电子邮件的 SMTP、用于万维网的 HTTP 等。

## TCP/IP 模型：
ARPA 在研究 ARPAnet 时提出了 TCP/IP 模型，模型从低到高依次为网络接口层(对应 OSI 参考模型中的物理层和数据链路层)、网际层、传输层和应用层(对应 OSI 参考模型中的会话层、表示层和应用层)。TCP/IP 由于得到广泛应用而成为事实上的国际标准。TCP/IP 模型的层次结构及各层的主要协议如图 1.11 所示。

![[Pasted image 20240702193607.png]]


（1）网络接口层：网络接口层的功能类似于 OSI 参考模型的物理层和数据链路层。它表示与物理网络的接口，但实际上 TCP/IP 本身并未真正描述这一部分，只是指出主机必须使用某种协议与网络连接，以便在其上传递 IP 分组。具体的物理网络既可以是各种类型的局域网，如以太网、令牌环网、令牌总线网等，也可以是诸如电话网、SDH、X.25、帧中继和 ATM 等公共数据网络。网络接口层的作用是从主机或结点接收 IP 分组，并把它们发送到指定的物理网络上。

（2）网际层：同我们的第四章

（3）传输层：与我们的学习到的传输层类似，提供**拥塞控制+连接建立**。

（4）应用层：应用层(用户-用户)包含所有的高层协议,如虚拟终端协议(Telnet)、文件传输协议(FTP)、域名解析服务(DNS)、电子邮件协议(SMTP)和超文本传输协议(HTTP)。

## 模型比较：
第一，OSI 参考模型的最大贡献就是精确地定义了三个主要概念：服务、协议和接口，这与现代的面向对象程序设计思想非常吻合。而 TCP/TP 模型在这三个概念上却没有明确区分，不符合软件工程的思想。

第二，OSI 参考模型产生在协议发明之前，没有偏向于任何特定的协议，通用性良好。但设计者在协议方面没有太多经验，不知道把哪些功能放到哪一层更好。TCP/IP 模型正好相反，首先出现的是协议，模型实际上是对已有协议的描述，因此不会出现协议不能匹配模型的情况，但该模型不适合于任何其他非 TCP/IP 的协议栈。

第三，TCP/IP 模型在设计之初就考虑到了多种异构网的互联问题，并将网际协议 (IP)作为一个单独的重要层次。OSI 参考模型最初只考虑到用一种标准的公用数据网将各种不同的系统互联。OSI 参考模型认识到 IP 的重要性后，只好在网络层中划分出一个子层来完成类似于 TCP/IP 模型中的 IP 的功能。

第四，**OSI 参考模型在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信**。而 TCP/IP 模型认为可靠性是端到端的问题，因此**它在网际层仅有一种无连接的通信模式，但传输层支持无连接和面向连接两种模式**。这个不同点常常作为考查点。

