### 地址分配：
P14. 考虑三个 LAN 通过两个路由器互连，如图 5.33 所示。
a.为所有接口分配 IP 地址。对于子网 1，请使用 192.168.1.xxx 形式的地址;对于子网 2，使用以下形式的地址192.168.2.xxx; 对于子网 3，使用格式为 192.168.3.xx 的地址.
b.将 MAC 地址分配给所有适配器。
c. 考虑将 IP 数据报从主机 E 发送到主机 B。 假设所有ARP 表是最新的。如对第 6.4.1 节（链路层寻址和 ARP）中的单路由器示例，列举所有步骤，。
d. 重复 （c），现在假设发送主机中的 ARP 表为空（并且其他表是最新的）。
![[Pasted image 20240702211107.png]]


分配思路：
第一步：我们首先确定我们的**每一个局域网内需要多少个地址，需要多少个 mac 地址**，我们首先对于每一个**路由器连接多少个网络，他就需要多少个对应的地址**。
**我们不需要给我们的交换机分配地址**。
![[Pasted image 20240702211213.png]]

游走思路（MAC 已知）：
1.E 中的转发表确定数据报应**路由**到接口192.168.3.002
2 E 中的适配器创建以太网目的地址为88-88-88-88-88-88的以太网**数据包**。
3.路由器2接收数据包并提取数据报。此路由器中的转发表指示数据报将路由到198.168.2.002
4.路由器2然后通过其接口发送目的地址为33-33-33-33-33-33，源地址为55-55-55-55-55-55的以太网数据包，IP地址为192.168.2.003

游走思路（MAC 未知）：
E中的ARP现在必须确定MAC地址192.168.3.002主机E在广播以太网帧内发出ARP查询报文。路由器2接收查询数据包并向主机E发送ARP响应数据包。该ARP响应数据包由以太网帧承载，以太网目的地址为77-77-77-77-77-77
5.该过程一直持续到数据包到达主机B.
### 循环冗余校验码 CRC
![[Pasted image 20240627152956.png]]

第一步：我们求出我们的除数是多少，由我们的多项式，我们知道我们的除数位：`1100011`,

第二步：找到我们的被除数是多萨和哦，这个就是我们的信息为：`1101110010001`

第三步：我们在我们的信息为后面添加 n 位 0，然后我们就可以得到我们的真正的被除数，之后进行我们的模二除法，也就是我们的异或运算即可。

第四步：异或运算后，我们求出我们的冗余码（**不足 n 位的要补足**），如果要求我们的冗余多项式，我们就可以通过我们的对应转换即可。

![[Pasted image 20240627153314.png]]

第一步：求出我们的冗余校验码
第二步：我们把对应的元数据和我们的校验码直接进行拼接，拼接后的结果就是我们的理论可行的答案。
第三步：我们采用我们的**模拟方法**，我们用我们的发送出去的数据除以我们的生成多项式，如果能够除尽，我们就认为没有出错，否则我们认为出错。

![[Pasted image 20240629105347.png]]
![[Pasted image 20240629105353.png]]
### CSMACD
**注意**，如果我们要求我们的实际时间，那么我们就用我们的**比特时间/链路传输速率**，就能得到我们的**实际等待时间**。

以太网规定了一个最短帧长64字节,即512bit

求最短帧长：
![[Pasted image 20240629110050.png]]

 二进制指数退避算法：
假设我们的发生了 $k$ 次重传，那么我们就在 $0-2^{k}-1$ 时间内，随机选择一个 $t$,再 $a*2t$ 之后，我们再去传输我们的数据同时，我们的 $10<=k<16$,我们的 $2^{k}$ 最大只能取 10，如果超过 16 次还没有成功，我们就放弃发送。
![[Pasted image 20240629110406.png]]



3-24 假定站点 A 和 B 在同一个 10 Mbit/s 以太网网段上。这两个站点之间的传摇时延为 225 比特时间。现假定 A 开始发送一帧，并且在 A 发送结束之前 B 也发送一帧。如果 A 发送的是以太网所容许的最短的帧，, 那么 A 在检测$64B$ 到和 B 发生碰撞之前能否把自己的数据发送完毕？换言之，如果 A 在发送完毕之前并没有检测到碰撞，那么能否肯定 A 所发送的帧不会和 B 发送的帧发生碰撞？(提示：在计算时应当考虑到每一个以太网帧在发送到信道上时，在 MAC 帧前面还要增加若干字节的前同步码和帧定界符。)

首先，因为我们使用了我们的 MAC 帧，并且给定了指定的格式，我们需要考虑我们的**封装成帧**。
![[Pasted image 20240629110753.png]]

于是，我们的真实的发送速率就是我们的 72 B
![[Pasted image 20240629110837.png]]

3-25 上题中的站点 A 和 B 在 t=0 时同时发送了数据帧。当 t= 225 比特时间，A 和 B 同时检测到发生了碰撞，并且在 t=225+48=273 **比特时间**完成了干扰信号的传输。A 和 B 在 CSMA/CD 算法中选择不同的 r 值退避。假定 A 和 B 选择的随机数分别是 rA=0 和 rB=1。试问 A 和 B 各在什么时间开始重传其数据帧？A 重传的数据帧在什么时间到达 B?A 重传的数据会不会和 B 重传的数据再次发生碰撞？B 会不会在预定的重传时间停止发送数据？
第一步：我们检查是否信道空闲，如果信道不空闲，我们不发送。我们就继续等待。
第二步：我们如果检测到信道空闲，我们检查在我们的信道空闲，直到我们的**一个最小帧间隔期间**是否**接收到数据**，如果是，我们就从**接收到数据往后重新计算最小帧间隔**。我们的最小帧间隔默认为 96
第三步：我们如果过程中，我们**检测到**碰撞，我们就采用我们的二进制退避算法，**先发送一个强化碰撞信号**，在我们的强化碰撞信号发送结束后，再去按照我们的**随机数**等待对应的时间。

我们检查我们是否有我们的随机数作为我们的随机重传的参数，如果有，我们就我们等待对应的 $2rt$ 事件后，来进行发送。
第三步：在我们**发送数据前**，我们还需要等待我们的**帧间最小间隔时间**，如果在这个期间内**存在我们的信道被占用**，我们就从我们的**占用后开始重等**。

我们的干扰信号是在我们的**收到碰撞后发出的**，强化碰撞的一个方式方法。
![[Pasted image 20240629111142.png]]
![[Pasted image 20240629111340.png]]

3-26 以太网上只有两个站，它们同时发送数据，产生了碰撞。于是按截断二进制指数退避算法进行重传。重传次数记为 i,i=1,2,3,...。试计算第 1 次重传失败的概率、第 2 次重传失败的概率、第 3 次重传失败的概率，以及一个站成功发送数据之前的平均重传次数1。

![[Pasted image 20240629114054.png]]

05. 对于下列给定的值，不考虑差错重传，非受限协议 (无须等待应答)和停止-等待协议的有效数据率是多少？(即每秒传输了多少真正的数据，单位为 b/s。)
$R=$ 传输速率 ( 16 Mb/ s) 
$S=$ 信号传播速率 ( 200 m/ us)
$D=$ 接收主机和发送主机之间传播距离 (200 m)
$T=$ 创建帧的时间 (2μs) 
$F= \textbf{每 帧 的 长 度 ( 500bit) }$
$N=$ 每帧中的数据长度 (450 bit) 
$A=$ 确认帧 ACK 的帧长 (80 bit)

我们首先要明确我们的**停止等待协议的流程**，我们会连续发送单个数据后，等待我们的发送方发送数据后才发送下一个。
![[Pasted image 20240702235338.png]]

 1)非受限协议 ( ) 非文限价以院、信、有效数据率 $\frac N{T+ \frac FR}= \frac {450\mathrm{bit}}{2\mathrm{μ s}+ \frac {500\mathrm{bit}}{16\mathrm{bits/ \mu s}}}\approx 13. 53$ bit/ $\mu$ s=13.53 Mb/ s

 2)停止等待协议 
 $=TTT=\frac N{2\times(T+D/S)+\frac{F+A}R}$ 岸)
$=\frac{450\mathrm{~bit}}{2\times(2\mu\mathrm{s}+\frac{200\mathrm{~m~}}{200\mathrm{~m~/\mu s}})+\frac{500\mathrm{~bit+80~bit}}{16\mathrm{~bit~/\mu s}}}$
$\approx10.65$ bit/μs=10.65 Mb/s

08.[2010 统考真题]某局域网采用 CSMA/CD 协议实现介质访问控制，数据传输速率为
$10\mathbf{Mb/s}$,主机甲和主机乙之间的距离是 2 km, 信号传播速率是 200000 km/s。请回答下列问题 , 要求说明理由或写出计算过程。
1) 若主机甲和主机乙发送数据时发生冲突 , 则从开始发送数据的时刻起 , 到两台主机均检测到冲突为止，最短需要经过多长时间？最长需要经过多长时间 (假设主机甲和主机乙在发送数据的过程中，其他主机不发送数据)
2) 若网络不存在任何冲突与差错，主机甲总是以标准的最长以太网数据帧(1518字节)向主机乙发送数据，主机乙每成功收到一个数据帧后立即向主机甲发送一个 64 字节的确认帧，主机甲收到确认帧后方可发送下一个数据帧。此时主机甲的有效数据传输速率是多少 (不考虑以太网的前导码)?

（1）当主机甲和主机乙同时开始发送数据，才能使得它们从开始发送数据时刻起，在链路中点处发生冲突，到两台主机均检测到冲突时刻止，经过的时间最短。如图 (a)所示。等价于信号从甲到乙的单程传播时延。由于速度为 200 000 km/s, 距离为 2 km, 经过的时间$t_{\mathrm{min}}= \tau = \frac sv= \frac {2\:\mathrm{km}}{200000\:\mathrm{km/ s}}= 10$ $\mu$ s .

当主机甲发送的数据经过 $\tau$ 时间传播无限接近于达到主机乙时，主机乙开始发送数据，此时立即发生冲突，主机乙立即检测到冲突，主机甲再经过 $\tau$ 时间检测到冲突。等价于信号从甲到乙的往返传播时延。如图 (b)所示。经过的时间 $t_\mathrm{max}=2\tau=20$ μs 。

（2）**注意到我们的传输效率等于我们的数据载荷除以总时间**，因为数据传输速率为 10 Mbps, 所以主机甲发送一个标准的最长以太网数据帧 (1518 字节) 的发送时延为 $t_1=1518$ B /10 Mbps=1214.4 μs, 传播时延为 $\tau=10$ μs。主机乙发送一个 64 字节的确认帧的发送时延为 $t_{2}=64$ B /10 Mbps=51.2 $\mu$ s, 传播时延为 $\tau=10\mu$ s。总的时延为 $t_1+\tau+t_2+\tau=1285.6\mu$ s 。一个以太网帧的传输过程如图 (c)所示：
![[Pasted image 20240702234425.png]]


## 交换设备计算
3-27 有 10 个站连接到以太网上。试计算以下三种情况下每一个站所能得到的帝宽
(1) 10 个站都连接到一个 10 Mbit/s 以太网集线器； 
(2) 10 个站都连接到一个 100 Mbit/s 以太网集线器；
(3) 10 个站都连接到一个 10 Mbit/s 以太网交换机。
![[Pasted image 20240629114330.png]]


