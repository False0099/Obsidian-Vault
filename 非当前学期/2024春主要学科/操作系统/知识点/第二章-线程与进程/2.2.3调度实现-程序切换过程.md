狭义的进程调度指的是从就绪队列中选中一个要运行的进程。(这个进程可以是刚刚被暂停执行的进程，也可能是另一个进程，后一种情况就需要进程切换)

进程切换是指一个进程让出处理机，由另一个进程占用处理机的过程。广义的进程调度包含了选择一个进程和进程切换两个步骤。

进程切换的过程主要完成了：
1. 对原来运行进程各种数据的保存
2. 对新的进程各种数据的恢复

注意：进程切换是有代价的，因此如果**过于频繁的进行进程调度、切换，必然会使整个系统的效率降低**，使系统大部分时间都花在了进程切换上，而真正用于执行进程的时间减少。

## 时机：
1. 我们当前的运行进程**主动放弃**了我们的处理机，例如我们的程序已经执行完毕，进程正常终止，进程主动请求阻塞时会产生我们的程序调度。
2. 我们的当前运行的程序**被动放弃**了我们的处理机。例如：分配给当前进程的时间片已经用完了，或者有更加高级的事情需要我们进行处理，或者有更高优先级的程序进入了就绪队列。

### 不能切换的条件：
1. 在**处理中断**的过程中，我们不能切换我们的进程。在**处理中断的过程**中。中断处理过程复杂，与硬件密切相关，很难做到在中断处理过程中进行进程切换。
2. 进程在操作系统**内核程序临界区**当中，我们不能切换我们的进程。（注意区分**临界区**与**操作系统内核程序临界区**，我们的**操作系统内核程序临界区**一般涉及到的临界资源都是我们的系统内核资源，例如我们的消息队列。）
3. 在**原子操作**过程中，原子操作不可中断。（在我们的原子操作中，连中断都不能进行，更不能去切换）在原子操作过程中（原语）。原子操作不可中断，要一气呵成（如之前讲过的修改PCB中进程状态标志，并把PCB放到相应队列）。

## 方式：
根据我们是**主动放弃**还是**被动放弃**，我们可以把我们的程序调度方式分为: 抢占式与非抢占式两类。
非剥夺调度方式，又称非抢占方式。即，只允许进程主动放弃处理机。在运行过程中即便有更紧迫的任务到达，当前进程依然会继续使用处理机，直到该进程终止或主动要求进入阻塞态。（**多用于批处理操作系统**）

剥夺调度方式，又称抢占方式。当一个进程正在处理机上执行时，如果有一个更重要或更紧迫的进程需要使用处理机，则立即暂停正在执行的进程，将处理机分配给更重要紧迫的那个进程。（**多用于分时操作系统，实时操作系统**）

## 闲逛进程：
在进程切换时，如果系统中**没有就绪进程**，就会**调度闲逛进程** (idle)运行，如果没有其他进程就绪，该进程就一直运行，并在执行过程中测试中断。闲逛进程的优先级最低，没有就绪进程时才会运行闲逛进程，只要有进程就绪，就会立即让出处理机。闲逛进程不需要 CPU 之外的资源，它不会被阻塞。

