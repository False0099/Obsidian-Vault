进程控制的主要功能是对系统中的所有进程实施有效的管理，它具有创建新进程、撤销已有进程、实现进程状态转换等功能。

在操作系统中，一般把进程控制用的程序段称为原语，原语的特点是执行期间不允许中断，它是一个不可分割的基本单位。使用原语的原因在于：我们的进程控制要**一气呵成**。

因为我们如果不能做到“一气呵成”，就可能会导致我们的操作系统中某些关键数据不统一，会影响操作系统进行其他的工作。
![[Pasted image 20240417133821.png]]

### 怎么实现我们的原语
我们的原语是通过我们的开中断和关中断来保证我们在同一个时刻只有一个元素来执行我们的对应代码。
没有关中断：
![[Pasted image 20240417133928.png]]
执行关中断：
![[Pasted image 20240417133946.png]]


## 创建态->就绪态：
### 操作
我们把我们的程序从我们的创建态转换到我们的就绪态需要通过我们的下面几个**原语**来进行：
1. 申请空白 PCB
2. 位新进程分配其运行所需的资源
3. 初始化 PCB
4. 将 PCB 插入就绪队列。

### 对应的事件：
1. 用户登录，分时系统中，用户登录成功，系统会为其建立一个新的进程
2. 作业调度，多批道处理系统时，有新的作业放入内存时，会为其创立一个新的进程
3. 提供服务，用户向操作系统提出某种请求时，会新建立一个进程处理请求
4. 应用请求，由用户进程主动请求一个子进程。

## 运行态->终止态：

### 对应的原语：
1. 从 PCB 中找到终止进程的 PCB
2. 若程序正在运行，立即剥夺 CPU，将 CPU 分配给其他资源
3. 终止其所有子进程
4. 将该进程拥有的所有资源归还给父进程或操作系统
5. 删除 PCB

### 对应事件：
 1. 正常结束：进程自己请求终止
 2. 异常结束：整数除以 0，非法使用特权指令，被操作系统干掉
 3. 外界干预：Ctrl+Alt+delete

## 运行->阻塞：
### 对应原语：
1. 找到要阻塞的进程对应的 PCB
2. 保护进程运行现场（），将 PCB 状态信息设置为“阻塞态”，暂时停止程序的运行
3. 将 PCB 插入相应事件的等待序列

### 引起阻塞的事件：
1. 需要等待系统分配某种资源
2. 需要等待相互合作的其他进程完成工作。

## 阻塞->就绪：

### 对应原语：
1. 找到要阻塞的进程对应的 PCB
2. 将 PCB 从等待队列中移除，设置进程为就绪态
3. 将 PCB 插入就绪队列，等待被调度。

### 引起事件：
等待时间的发生