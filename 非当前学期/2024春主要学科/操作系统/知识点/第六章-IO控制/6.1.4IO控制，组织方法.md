IO 设备管理的一个重要任务是控制 I/O 设备和内存或 CPU 之间的数据传送。
根据 I/O 设备控制器功能的强弱，以及和 CPU 之间联系方式的不同，I/O 设备的控制方式主要分为一下四类：
1. 程序直接控制方式
2. 中断控制方式
3. DMA 方式
4. 通道方式。

## 程序直接控制方式
我们的思路是，直接将我们的 IO。和对应使用我们 IO 设备的程序之间建立一个联系，从而只有当我们 IO 程序完成后，我们才能够执行我们的对应的联系，这就导致我们的程序控制速度很低，效率很低。**我们的处理器代表进程向我们的 IO 模块发出 IO 指令，该进程进入忙等待，直到完成操作再去执行**

在我们的程序直接控制方式中，我们会把我们的 IO 数据存放在**寄存器当中**。

![[Pasted image 20240619200139.png]]
## 中断控制方式：
中断驱动方式的思想是，允许 IO 设备主动打断 CPU 的运行并请求服务，从而“解放”CPU, 使得其向 IO 控制器发送读命令后可以继续做其他有用的工作。如图 5.3(b)所示，我们从 I/O 控制器和 CPU 两个角度分别来看中断驱动方式的工作过程。

也就是说，我们的**CPU 发出 I/O 命令后可以做其他事，本次 IO 完成后设备控制器发出中断信号**。处理器代表进程发出 IO 命令，如果是非阻塞，处理器继续执行。

从 I/O 控制器的角度来看，I/O 控制器从 CPU 接收一个读命令，然后从外部设备读数据。一旦数据读入 IO 控制器的数据寄存器，便通过控制线给 CPU 发出中断信号，表示数据已准备好，然后等待 CPU 请求该数据。I/O 控制器收到 CPU 发出的取数据请求后，将数据放到数据总线上，传到 CPU 的寄存器中。至此，本次 IO 操作完成，IO 控制器又可开始下一次 IVO 操作。
从 CPU 的角度来看，CPU 发出读命令，然后保存当前运行程序的上下文 (现场，包括程序计数器及处理机寄存器), 转去执行其他程序。在每个指令周期的末尾，CPU 检查中断。当有来自 IO 控制器的中断时，CPU 保存当前正在运行程序的上下文，转去执行中断处理程序以处理该中断。这时，CPU 从 IO 控制器读一个字的数据传送到寄存器，并存入主存。接着，CPU 恢复发出 IO 命令的程序 (或其他程序)的上下文，然后继续运行。

这样的缺点是，我们的每一次和我们的 I/O 设备的**读写仍然需要通过我们的寄存器**。也因此，我们仍然需要通过我们的寄存器来实现我们的最终的数据传输。

![[Pasted image 20240619200757.png]]

## DMA 方式：

**DMA 模块控制主存储器和 IO 设备之间的数据交换**。只在我们的初始时刻和我们的终止时刻进行我们的数据交换。

在中断驱动方式中，IO 设备与内存之间的数据交换必须要经过 CPU 中的寄存器，所以速度还是受限，而 DMA (直接存储器存取)方式的基本思想是在 IO 设备和内存之间开辟直接的数据交换通路，彻底“解放”CPU。

DMA 方式的特点如下：
1)基本**单位是数据块**。
2)所传送的数据，是从设备**直接送入内存**的，或者相反。
3)仅在传送一个或多个数据块的**开始和结束**时，才需 CPU 干预，**整块数据的传送是在 DMA 控制器的控制下完成的**。

因此，我们需要再我们的 DMA 中设置**四类寄存器**，分别是我们的**地址寄存器**，**数据寄存器**，**命令寄存器**，**数据计数器**

![[Pasted image 20240619201052.png]]
## 通道方式：
IO 通道是指**专门负责输入输出的处理机，具有专门的指令集**。IO 通道方式是 DMA 方式的发展，它可以进一步减少 CPU 的干预，即把对一个数据块的读 (或写)为单位的干预，减少为对一组数据块的读 (或写)及有关控制和管理为单位的干预。同时，又可以实现 CPU、通道和 IO 设备三者的并行操作，从而更有效地提高整个系统的资源利用率。

例如，当 CPU 要完成一组相关的读 (或写)操作及有关控制时，只需**向 IO 通道发送一条 IO 指令**，以给出其所要执行的通道程序的首地址和要访问的 IO 设备，通道接到该指令后，**执行通道程序**便可完成 CPU 指定的 I/O 任务，数据传送**结束时向CPU 发中断请求**。

![[Pasted image 20240619201507.png]]
