## SPOOLING （假脱机）技术
为了缓和 CPU 的高速性与 I/O 设备低速性之间的矛盾，引入了脱机输入/输出技术，它是操作系统中采用的一项将独占设备改造成共享设备的技术。该技术利用专门的外围控制机，将低速 IO 设备上的数据传送到高速磁盘上，或者相反。

也就是说，我们的脱机技术的目的是，**不要让我们的 IO 设备占用我们的 CPU**。所谓的脱机也就是说**脱离 CPU 的控制进行 IO 操作**。

### 脱机技术：
我们在没有引入脱机技术之前，我们都是直接让我们的数据和我们的 CPU 进行交互，这样就会导致我们的数据输入和输出的效率称为我们的数据运行的瓶颈。显然，这不是一个好的方案。于是，我们就发明了脱机技术。

脱机技术，就是将我们的输入和输出通过一个外围控制机，连接到我们的外存当中，然后由我们的外村和我们的 CPU 进行我们的正式的交互。

### 假脱机技术
SPOOLing 系统的组成如图 5.12 所示。

![[Pasted image 20240619173705.png]]

我们的 Spolling 技术由我们的下面的部分来实现：
1. 输入井输出井，这个部分是我们用于模拟我们脱机技术时的磁带，收留我们的用户进程的输入输出数据。
2. 输入进程输出进程：这个部分是我们用于模拟我们的外围控制机的。**通过我们的这一个进程，我们和我们的用户程序并行执行**，总而模拟我们的 CPU 当中的 IO 功能。因此，我们的 SPOOLING 技术一定是需要我们的**多道程序**的。
通过这一项技术，我们的阅读数据不必要每一次都直接从我们的 IO 设备，而是通过了一个中转的设备，解决了我们的速度之间的矛盾，使得我们的速度能够得到一定程度的提高。

### 原理分析：
当多个用户提出输出打印的请求时，系统会答应他们的请求，但是并不是真正的把打印机分配给他们，而是由假脱机管理进程为每一个进程做两件事：
1. 在磁盘输出井中为进程申请一个空闲缓冲区（**内存当中**），并将打印的数据送入其中
2. 为用户进程申请一张空白打印表，并将用户的打印请求填写在表中，再将该表挂到假脱机队列当中。
3. 当打印机空闲时，输出进程会从文件队列队头取出一张打印请求表，并根据该表格中的要求将要打印的所有数据从输出井传送到输出缓冲区，再输出到打印机。

## 怎么节省时间？
从前述内容我们了解到，磁盘是一种高速设备，在与内存交换数据的速度上优于打印机、键盘、鼠标等中低速设备。试想一下，若没有 SPOOLing 技术，CPU 要向打印机输出要打印的数据，打印机的打印速度比较慢，CPU 就必须迁就打印机，在打印机把数据打印完后才能继续做其他的工作，浪费了 CPU 的不少时间。在 SPOOLing 技术下，CPU 要打印机**打印的数据可以先输出到磁盘的输出井中**(这个过程由假脱机进程控制),然后做其他的事情。若打印机此时被占用，则 SPOOLing 系统就会把这个打印请求挂到等待队列上，待打印机有空时再把数据打印出来。向磁盘输出数据的速度比向打印机输出数据的速度快，因此就节省了时间。