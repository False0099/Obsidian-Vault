## 总线裁决
一次总线传输分为四个阶段：
1. 总线裁决：决定哪个主控设备使用总线
2. 寻址阶段：主控设备送出要访问的主存或设备的地址，同时送出有关命令，启动从设备
3. 数据传输阶段：主、从设备间进行数据交换
4. 结束阶段：有关信息在总线上撤销，让出总线使用

总线裁决------》判优控制。

如何进行？
1. 确定总线主控设备
主控设备（如 CPU, IOP)
IOP：输入输出控制器
从设备：只能相应主控设备发来的总线命令（如：主存
2. 利用总线裁决决定哪个主控设备将得到使用权
3. 只有具有总线使用权的主控设备才能控制总线
![[Pasted image 20230807222829.png]]

## 裁决方式 ：
1. 集中裁决
将总线控制逻辑做在一个专门的总线控制器中，通过将所有的总线请求集中，利用特定算法进行裁决
2. 分布裁决
控制逻辑分布在各个部件或设备中

总线裁决信号线
类型：总线请求线、总线许可线、总线忙
使用方式：专用/复用

影响因素
1. 等级：优先满足高优先级的设备
2. 公平性：保证每个设备都能够有机会适用总线

## 集中式裁决算法 ：
1. （菊花）链查询方式
![[Pasted image 20230807223416.png]]
我们的 `BS,BR,BG` 都属于我们的控制总线。我实现这一种高一功只需要 3 根线。
#### 流程 ：
第一步：假设哦我们的设备 0 和设备 1 都需要使用，我们两个设备都会向我们的 `BR` 发送一个信号，

第二步：总线控制部件检测到我们的 `BR` 信号，我们通过我们的 `BG` 来进行我们的允许信号，

第三步：我们每一个设备分别检查是否有需求，按照我们的 `BG` 连接顺序，来决定我们第一个接收到我们的 `BG` 的设备是哪一个，由这个设备来控制我们的总线，并向我们的 `BS` 发动一个信号，表示我们的设备忙

第四步 : 设备使用完毕，我们会把我们的  `BS` 置为 0，我们会再次进行我们的第三步，直到我们最后全部结束。


#### 性质：
越靠近我们的总线控制部件，我们的优先级就越高，优先级相对固定。
缺点：因为我们是并行连接的，所以我们**一个坏就全都坏**

2. 计数器定时查询
![[Pasted image 20230807223556.png]]
这里，我们的控制线，需要有一共 $(\log_{2}n)+2$ bit 的控制线，其中，我们的 n 表示我们的设备总数，我们的 $log_{2}n$ 表示我们的总线允许线，1bit 作为我们的总线请求，1bit 作为我们的总线忙。
#### 步骤 ：
第一步：假设我们的设备 0 和设备 1 都需要使用，我们两个设备都会向我们的 `BR` 发送一个信号，

第二步：总线检查到我们的 `BR` 信号，我们判断我们的总线空闲时，我们的 ``计数器`` 开始计数，计数值通过哦我们的各个设备线发向各个部件。如果对应计数值和我们的需求匹配后，我们就会暂停计数，我们 `BS` 线置为 1

第三步 : 设备使用完毕，我们会把我们的  `BS` 置为 0，我们会再次进行我们的第三步，直到我们最后全部结束。


![[Pasted image 20230807224128.png]]

方法三：独立请求方式
![[Pasted image 20230807224001.png]]

每一个设备都需要两个线，一个是我们的 BR 线，一个是我们的 BS 线，因此我们首先需要 $2n$ bit 的线而我们这个时候，还需要一条总线来连接我们所有的 I/O 接口到我们的排队线。因此我们一共需要 $2n+1$ 根线

结构特点：每个设备都有一对总线请求线和我们的总线允许线。当接收到多个信号时，我们的总线控制部件中存在一个排队器，能够帮助我们裁决那一个设备使用我们的总线。
![[Pasted image 20230807224117.png]]


## 分布式仲裁方法
![[Pasted image 20231206173858.png]]