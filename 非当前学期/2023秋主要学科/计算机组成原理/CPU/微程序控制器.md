![[Pasted image 20231008133141.png]]
**微程序控制器**基本结构
控制存储器：CM，用于存放各指令对应的微程序，用 ROM 构成（相当于我们的**主存**）

微地址寄存器 CMAR：类似于我们 CPU 中 **MAR** 的作用

微地址形成部件：产生初始微地址和后继微地址，


![[Pasted image 20231008133552.png]]

顺序逻辑：

CMDR: 存放从 CM 中取出的微指令，他的位数同微指令字长相等。

![[Pasted image 20230813232615.png]]

![[Pasted image 20231008134124.png]]

## 微指令的格式设计
1. 指令格式和对应优缺点
![[Pasted image 20230814213154.png]]
对于水平型操作控制字段，我们如果采用*字段直接编码方式*我们的字段分段做出如下规定：
1. 互斥性内容在同一段内，相容性微命令在不同段内。
2. 每一个段内要留出一个状态，表示不发生任何操作。‘

如果我们采用*直接编码方式*，那么在微指令的操作控制字段中，每一位代表一个微操作命令，某位为 1，表示有效。

对于地址码字段，我们可以分为两种
方法一：微指令的下地址字段指出，
方法二：根据机器指令的操作码形成
方法三：有增量计数器获得
方法四：分支转移，操作字段的后半部分
![[Pasted image 20230814215313.png]]

![[Pasted image 20230813234329.png]]



微程序的设计
1. 分析每个阶段的微操作时序
2. 写出对应机器指令的微操作命令以及节拍安排
(1)写出每个周期所需的微操作
(2)补充微程序控制器特有的微操作
	a.每条微指令结束后都要执行的
	Ad (CMDR)->CMAR
	OP (IR)->微地址形成部件->CMAR
	b.执行周期：
	Ad (CMDR)->CMAR

