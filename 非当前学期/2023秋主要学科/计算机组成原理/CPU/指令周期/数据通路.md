数据在功能部件之间传送的路径称为数据通路，包括数据通路上流经的部件，如 ALU、通用寄存器、状态寄存器、异常和中断处理逻辑等。数据通路描述了信息从什么地方开始，中间经过哪个寄存器或多路开关，最后传送到哪个寄存器，这些都需要加以控制。

数据通路由**控制部件控制**，控制部件根据每条指令功能的不同生成对数据通路的控制信号。数据通路的功能是实现 CPU 内部的运算器与寄存器及寄存器之间的数据交换。

数据通路可以实现：
1. 寄存器内数据传输
2. 主存和 CPU 之间的数据传输
3. 执行算数或逻辑运算

关于数据通路，我们需要研究：
1. 数据传输的方式
2. 数据传输的步骤



## 基本结构
数据通路的基本结构主要有以下几种： 
1) CPU 内部单总线方式。将所有寄存器的输入端和输出端都连接到一条公共通路上，这种结构比较简单，但数据传输存在较多的冲突现象，性能较低。连接各部件的总线只有一条时，称为单总线结构；CPU 中有两条或更多的总线时，构成双总线结构或多总线结构。

2) CPU 内部三总线方式。将所有寄存器的输入端和输出端都连接到多条公共通路上，相比之下单总线中一个时钟内只允许传一个数据，因而指令执行效率很低，因此采用多总线方式，同时在多个总线上传送不同的数据，提高效率。

3) 专用数据通路方式。根据指令执行过程中的数据和地址的流动方向安排连接线路，避免使用共享的总线，性能较高，但硬件量大。
 


## CPU 内部单总线
同一时刻**只允许两个部件之间发生数据交换**

### 1 .寄存器间的数据传送
（以把PC的内容送至MAR为例）
STEP1:(PC)->Bus(总线)

把PC内容送主线

STEP2：Bus->MAR

主线送进MAR
![[Pasted image 20231007105831.png]]
### 2 .主存与 CPU 之间的数据传送
（CPU 从主存读取命令为例，也就是我们的**取指周期**所做的事情）

STEP1:PC->Bus->MAR
现行指令地址->MAR

STEP2:1->R
CU发读命令

STEP3:MEM(MAR)->MDR
(MDRin)有效

STEP4:MDR->Bus->IR
MDRout和IRin有效，现行指令->IR
![[Pasted image 20231007110131.png]]


### 3 .执行算数或逻辑运算
（假设我们执行一条加法指令，也就相当于我们的**执行周期，和我们的间址周期**）
STEP1: AD(IR)->Bus->MAR

取出我们的指令地址

STEP2: 1->R

读入常规操作

STEP3: MEM(MAR)->数据线->MDR

由地址转换为我们的数据

STEP4: MDR->BUS->Y(暂存寄存机)

把我们得到的数据加入到我们的寄存器中

STEP5:(ACC)+(Y)->Z

直接进行一波计算

STEP6: Z->ACC

结果返回我们的 ACC

![[Pasted image 20230812234417.png]]



例题 1：ADD 指令的数据流动
取值周期
![[Pasted image 20230813002054.png]]


间址周期
![[Pasted image 20230813002417.png]]

数据处理：


遵循顺序：取指->间址（取数据）

## 专用数据通路
专用数据通路能够满足我们在多个部件之间同时进行我们的流动，**在任何两个需要数据流动的之间都建立一个专用线路，而不用走我们的总线**
![[Pasted image 20231130111511.png]]
### 取址周期
1. PC->MAR    我们的 `C0` 有效，我们把我们 `PC` 中的数据传入到我们的 `MAR` 中
2. (MAR)->主存
我们的 `C1` 有效，我们根据我们的地址找到我们对应的指令在主存中的地址。

4. 1->R 打开我们的写控制线，控制主存单元向主存发送命令。

5. M(MAR)->MDR `C2` 有效，把我们 `MAR` 地址对应的内容（操作数、数据）放入我们的 `MDR` 中。

6. MDR->IR   `C3` 有效，把我们的 `MDR` 中的指令放入到对应的 `IR（指令寄存器）` 中。

7. PC+1->PC（执行完一条指令后，我们的 `PC` 寄存器自动++）



8. OP(IR)->CU（`C4` 有效，让我们的控制器执行对应操作。）
指令译码操作




例题：
![[Pasted image 20231007111739.png]]

第二问：
![[Pasted image 20231007111809.png]]
第三问：
![[Pasted image 20231007111946.png]]
第四问：
![[Pasted image 20231007112211.png]]
第五问：
![[Pasted image 20231007112151.png]]

第六问：
![[Pasted image 20231007112259.png]]
