# 8.1 外围设备的定时方式和信息交换方式 
1.输入输出系统的构成
管理软件+接口+设备控制器+外围设备
2. 输入、输出的两个传输阶段
	1. CPU 与 I/O 接口之间的数据传送
	2. I/O 接口与外设间的数据传送
3. 需要解决的问题：
	1. 高速的 cpu 与外设之间的数据交互
		根据不同的外设选择不同的数据传送方式，速度慢的，我们就直接传输，对于慢速或中速，我们就采用应答方式（异步传送方式）高速外设，就采用同步传送方式。
4. 数据传输类型
	1. 简单 IO
		CPU 认为外设时钟处于就绪状态，直接通过数据口输入或输出数据
		特点：接口电路简单，硬件成本低
		可能出现丢失数据、覆盖数据或重复输入的情况。
		电路简单、开销小
	1. 程序查询
		CPU 根据查询到的外设状态，控制数据何时进行输入输出操作
		特点：CPU 需要不断地查询并等待相对慢速的外设
		效率低，CPU 与外设不能并行
		接口电路简单，硬件开销小
	1. 程序中断方式
		当外设需要 CPU 服务时，通过接口向 CPU 发送中断程序请求。CPU 在当前机器指令执行完毕后暂停正在执行的主程序，转去执行中断服务程序。
	2. 直接存储器存取
		通过硬件控制实现主存与 I/O 设备间的数据传送
		特点：速度快
		
	1. 通道方式
		当计算机的规模变大后，我们就设计了一种具有特定功能的简单处理器，让他能处理

## 8.2 程序查询方式
1. 查询传送方式
![[Pasted image 20230801214126.png]]
多态外设的程序查询过程
![[Pasted image 20230801214203.png]]
中断（当我们从主程序中插入一个外设的程序）

## 程序中断方式
中断指 cpu 暂停现行程序的执行，转去处理随即发生的紧急事件，处理完后再处理。
中断系统包括
1. CPU 中的中断机构
2. 系统中的中断控制器
3. 软件上设置的中断服务程序

中断源：
输入输出中断：已做好输入输出准备
数据通道中断：磁盘同主机进行数据交换
实时时钟中断
故障中断：电源掉电
系统中断：运算过程出现溢出
断点中断：故意的

中断处理过程
![[Pasted image 20230801214948.png]]

外设发中断请求----》中断排队与判优-----》中断响应（暂停执行---》关中断----》保存返回地址---》查找中断源）----》中断处理（保护现场--》设备服务--》回复现场--》开中断---》中断返回）

中断源的识别
在单级中断中，采用串行排队链来识别
或采用中断控制器来识别是哪个设备发出的

转中断服务程序：
1. 预先规定中断服务程序的入口地址
2. 获取中断向量，通过查表找到入口地址 ![[Pasted image 20230801215612.png]] ![[Pasted image 20230801215823.png]]
中断方式的基本 I/O 接口
![[Pasted image 20230801220204.png]]

中断处理策略：
单级中断：完成后才进行下一个，不允许中断嵌套 ![[Pasted image 20230801220949.png]]
![[Pasted image 20230801221602.png]]

多级中断
中断嵌套方式
优先级高的中断级可以打断优先级低的中断服务程序，中断服务程序以嵌套方式进行工作
![[Pasted image 20230801222009.png]]

![[Pasted image 20230801222135.png]]






练习：![[Pasted image 20230801222750.png]]![[Pasted image 20230801222829.png]]
![[Pasted image 20230801222812.png]]
![[Pasted image 20230801223347.png]]


### DMA 方式
1. 完全由硬件实现，数据交换不经过 CPU ![[Pasted image 20230801223654.png]]
传送过程
申请---》相应----》数据传送-----》传送结束
![[Pasted image 20230801224212.png]]

![[Pasted image 20230801224223.png]] ![[Pasted image 20230801224235.png]] ![[Pasted image 20230801224245.png]] ![[Pasted image 20230801224255.png]]
![[Pasted image 20230801225712.png]]


## 通道方式