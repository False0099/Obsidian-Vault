1. 选择两个大质数 P, Q，计算出 $N=P\times Q$
2. 计算出 N 的欧拉函数，又我们欧拉函数的积性，我们有 $\phi(N)=(p-1)(q-1)$
3. 我们选择一个与 $\phi(N)$ 互质的数字 $e$
4. 对我们的 e, 求出 e 对 $\phi(N)$ 的逆元 $d$,
5. 假设我们现在有一个明文 m，我们的加密方法就是我们的 $C=pow(m,e,N)$,这样我们就能得到我们加密后的 C
6. 对我们的密文 C 解密，我们需要得到 $c=pow(C,d,N)$

其中，我们的 N 是我们已知的，C 也是已知的，**只要我们能把我们的 N 分解成我们的两个大质数，那么我们的 d 也就简单可得了**。但是这个显然是困难的。但是我们先知道了我们再去求就是相对方便的。

1. 我们的公钥 e，和我们的密钥 d 的关系：
$e*d \text{ mod N}=1$，其中我们的 $N$ 已知，e 是 d 的逆元，d 也是 e 的逆元
总结：
1. （N，e）公钥
2. （N，d）私钥

题型：
1. 已知 p, q, dp, dp, C, 求明文，其中,我们的 $c$ 是我们的密文，p 是我们的大质数 a，q 是我们的大质数 b，dp=d (mod p-1), dq=d (mod q-1), 这里 d 是我们的私钥

这里，我们使用我们的中国剩余定理，我们最终要求的是我们的 $m=c^d\text{mod n}$,（密文解密公式）我们于是就可以把哦我们的式子拆分成下面的两个式子：$m_{1}=c^d\text{mod p}$, $m_{2}=c^d\text{mod q}$。而我们的第一个等式可以推导出：$m_{1}=c^{dp}\text{(mod p)}$, $m_{2}=c^{dq}\text{(mod q)}$,于是我们就能够推导出我们的 m。

2. 已知 $p$, $q$, $e$,求 $n,\phi(n),d$,
$N=p*q,\phi(N)=(p-1)(q-1),d=e^{-1}\text{mod } \phi(N)$

3. 如果 N 可以分解时，我们直接就可以通过我们的网站进行相对应的分解，然后就能知道 p，q, e。

4. 已知 $e,N, \frac{dp}{dq},C$ 求明文
由我们的等式 $e\times d=1 \text{ mod phi}$,我们就有 $e\times d=1(\text{mod }p-1)$,又因为我们的 $dp=d(\text{mod p-1})$,所以我们就有 $e\times dp=1\text{mod p-1})$,于是我们就有恒等式：
$e\times dp=1+k(p-1)$,之后我们就可以用我们的枚举法来进行计算我们的 p 了。

5. 共模攻击
假设我们有两组以及以上的 RSA 加密过程，而且其中两次的 m 和 n 都是相同的，那么我们就可以在不计算出 d 而直接计算出 m 的值。也就是给定了同一个明文，同一个 N，但是我们的公钥密钥不同，问我们最后

假设我们有两组，设模数为 $n$,两个用户的公钥分别为 $e_{1},e_{2}$,且 $e_{1},e_{2}$,互素，明文为 m，密文分别为 $c_{1},c_{2}$,在已知 $e_{1},e_{2},c_{1},c_{2},n$ 的情况下，我们有
$c_{1}=m^{e_{1}} \text{mod n}$
$c_{2}=m^{e_{2}}\text{mod n}$
有扩展欧几里得，如果我们的 $a,b$ 互素，存在 $s_{1},s_{2}$,使得我们有 $a\times s_1+b\times s_{2}=1$,于是我们就有 $c_{1}^{s_{1}}\times c_{2}^{s_{2}}=m(\text{mod n})$

于是，我们就可以推导我们的密钥了。

6. 给定多组 n，e, d
考虑 n 之间存在公因数，若存在公因数，我们就可以通过我们的分解质因数得到 q，p，最终得到 m。

7. 低加密指数共计
1. 如果我们的 e 很小，由于 $m<n$,在 e 很小的情况下，很大程度上我们有 $m^e<n$ 成立，那么我们就可以对 c 开根求得 m，
2. 如果我们的 $m^e>n$,但没有超过很多，我们可以进行爆破 k，以此来求得 m，因为我们有 $m^e=k*n+m$,于是我们就可以枚举我们的 k，然后再暴力开三次方根，

8. 低解密指数攻击：知道 e, n, c, 且 e 长度较大，我们可以用连分数来破解。相当于在我们的 e 很大时，我们可以猜测出我们的 d 的对应值是多少。
![[Pasted image 20231119192500.png]]

9. RSA 证书公钥解密
我们需要先把我们的证书丢到我们的特定网站中得到我们的 N 和 e，然后再去操作。

10. copperSmith 攻击