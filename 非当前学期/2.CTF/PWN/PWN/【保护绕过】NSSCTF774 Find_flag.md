拖入 checksec 发现我们保护全开
![[Pasted image 20240217112616.png]]

拖入 IDA，发现存在格式化字符串漏洞函数：
![[Pasted image 20240217112652.png]]

于是，我们就可以通过我们的格式化字符串去泄露出我们的地址，这里，我们可以通过我们的 gdb 动态调试找到我们的 canary 和程序基地址。
![[Pasted image 20240217112804.png]]

通过观察，我们不难发现，我们的
0x7fffffffde28位置存储了 canary  
0x0x7fffffffde38位置储存了 mov eax ，0

而我们的格式化字符串的第一个参数的地址是：0x7fffffffddd0

计算可得，0xe28-0xdd0=0x58  
0xe38-0xdd0=0x68  
0x58/8=11  
0x68/8=13  
并且由于x64中格式化字符串的前六个参数储存在寄存器中，所以两个相对格式化字符串的偏移为17及19  
所以使用 `%17$p` 和 `%19$p` 分别泄露偏移为17和19位置储存的地址

接受后，因为存在后门函数，所以我们直接用我们的程序基地址和我们的后门函数末尾相加即可。