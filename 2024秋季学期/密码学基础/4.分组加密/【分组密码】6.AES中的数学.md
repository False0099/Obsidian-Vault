AES 中用 32 bit / 4 字节表示一个数据块，用字表示。一个字节的全体256种取值构成一个 $GF(2^{8})$,具体的转换方式，可以用下面的方法来进行计算：我们取我们的字符十六进制中的每两位作为答案。

一个 $GF(2)$ 上的 8 次多项式就可以生成一个 $GF(2^{8})$。$GF(2^{8})$ 的全体元素构成加法交换群、线性空间。$GF(2^{8})$ 的元素构成乘法交换群。$GF(2^{8})$ 中的元素有多种表示：
字节：$GF(2^8)=\{(a_7,a_6,...a_1,a_0)|a_i\in GF(2)\}$
多项式形式 : $GF( 2^8) = \{ a_7x^7+ \ldots + a_1x+ a_0| a_i\in GF( 2) \}$ 上海水下指数形式：$GF( 2^8) ^* = \{ \alpha ^0, \alpha ^1. . . \alpha ^{254}\}$, $\alpha$ 是一个本原元对数形式：$GF(2^8)^*=\{0,1\ldots254\}$

AES 采用 $GF(2)$ 上既约多项式 $m\left(x\right)$ 生成 $GF(2^8):$$m\left(x\right)=x^8+x^4+x^3+x+1$
![[Pasted image 20241224000555.png]]

例子：
字：0 x57834AD1
$字多项式：57x^3+83x^2+4Ax+D1$

## 群域理论
### 群
一个群是一个集合，和集合上的运算，我们记我们集合上的运算为 $f$,那么我们应该由下面的性质：
1. $a\circ b=c\in G$（运算必须是封闭的，运算后的结果仍然一定在我们的原来的集合当中）
2. 存在一个单位元，满足 $a \circ 1=a$。
3. 对于每一个 $G$ 中的元素 $a$,我们都存在一个对应的逆元，满足 $a \circ a^{-1}=1$
4. 我们的运算满足我们的结合律，即 $a \circ b\circ c=a\circ(b \circ c)$。也就是我们的加法结合律，乘法结合律等等。
5. 如果我们的运算还满足我们的交换律，那么我们的群是一个交换群（阿贝尔群）。

常见的伽罗瓦域：有限域中的加法运算（带模加法），异或运算（带模加法）

### 域：
域是满足下面定义的数字和操作的集合：
1. 一个域 $F$ 是一系列元素的集合，并且一个域中一定包括我们的乘法和加法（也就是说，域中应该包含两个元素）。
2. 我们的对应的乘法构成我们的阿贝尔群（可交换群）
3. 我们的加法也构成我们的阿贝尔群（可交换群）。
4. 我们的对应的运算满足分配律 $a(b+c)=ab+ac$

常见的域：实数域上的加法乘法、
### 伽罗瓦域：
加入我们的域的元素个数是有限的，那么我们就把这一个域叫做伽罗瓦域，或者有限域。例如 $GF(2^{n})$。就表示我们的一个有限域。

### 扩域 (Extension Field)
我们的扩域一般指我们的域中的元素是**多项式**。如下所示的域 $GF(2^{m})$。对于这样的代数结构，我们的每一个元素都由一个**多项式构成**，例如，我们的下面的一个多项式，
$$
A(x)=a_{7}x^{7}+\dots+a_{0} \ a_{i}\in(GF(2))
$$


### 扩展域加法
我们定义扩展域中的加运算如下：
$C(x)=A(x)+B(x)=\sum_{i=0}^{m-1}c_{i}x^{i}$
其中，我们的 $c_{i}=a_{i}+b_{i}\text{ mod } 2$
$$\begin{aligned}&01010111+10000011=11010100\\&0x57+0x83=0xD4\\&(\mathrm{x}^6+\mathrm{x}^4+\mathrm{x}^2+\mathrm{x}+1)+(\mathrm{x}^7+\mathrm{x}+1)=\mathrm{x}^7+\mathrm{x}^6+\mathrm{x}^4+\mathrm{x}^2\end{aligned}$$


$\left(\mathrm{x}^{6}+\mathrm{x}^{4}+\mathrm{x}^{2}+\mathrm{x}+1\right)^{*}\left(\mathrm{x}^{7}+\mathrm{x}+1\right)$ mod $\mathrm{x} ^{8}+ \mathrm{x} ^{4}+ \mathrm{x} ^{3}+$ x+1
$=x^7+x^6+1$

$0\times57^*0\times83=0$ xC 1

同理，我们的对应的减法也可以进行下面的定义：
$C(x)=A(x)-B(x)=\sum_{i=0}^{m-1}c_{i}x^{i}$,
其中，我们的 $c_{i}=a_{i}-b_{i}\text{ mod 2}$

### 扩展域减法
这个时候，我们的对应的乘法定义如下：
$P(x)=A(x)\times B(x)$,最后我们的结果还需要对于我们的 $P(x)$ 来进行整除，也就是我们要用不可约多项式来对我们的内容进行化简。也就是说：
$P_{0}=a_{0}b_{0},P_{1}=a_{0}b_{1}+a_{1}b_{0}$


### 扩展域乘法
例如，我们现在有两个多项式相乘：
$A(x)=x^{3}+x^{2}+1$, $B(x)=x^{2}+x$,在我们的 $GF(2^{4})$ 域中，我们跟定我们的 $P(x)=x^{4}+x^{3}+x{^2}+x^{1}$。

第一步：计算两个多项式在实数域的乘法，并在模 2 意义下化简：
$C(x)=x^{5}+x^{4}+x^{4}+x^{3}+x^{2}+x$
$C(x)=x^{5}+x^{3}+x^{2}+x$

第二步：对于高次项，采用膜法, 例如对于我们的五次方向，注意到：
$$
\begin{align}
x^{1}P(x)=x^{5}+x^{4}+x^{3}+x^{2}
\end{align}
$$
然后将上面的式子与我们的 $C(x)$ 进行异或可以得到：
$C(x)=x^{4}+x^{3}+x^{2}+x^{1}$


于是，我们就可以通过我们的下面的方法来进行花间：
$C(x)=x^{5}+x^{3}+x^{2}+x\text{mod P(x)}$。最终等于我们的 $x^{3}$

此时，如果我们把我们的对应的系数提取出来，我们就可以得到一个下面的多项式乘法：
$(1,1,0,1)\times(0,1,1,0)=(1,0,0,0)$

对于乘法，我们的一种常见的方法是，通过**矩阵来表示**。
设

$a(x)=a_3x^3+a_2x^2+a_lx+a_0$ $c(x){=}c_3x^3+c_2x^2+c_lx+c_0$ $b(x){=}b_3x^3+b_2x^2+b_lx+b_0$
则，$b(x)=a(x)c(x)$ mod $x^4+1$ 为：
$$a(x)c(x)\max a_1+a_2c_2+a_1c_3\\b_0=a_0c_0+a_3c_1+a_2c_2+a_1c_3\\b_1=a_1c_0+a_0c_1+a_3c_2+a_2c_3\\b_2=a_2c_0+a_1c_1+a_0c_2+a_3c_3\\b_3=a_3c_0+a_2c_1+a_1c_2+a_0c_3$$
$$\left.\left|\begin{array}{c}b_0\\b_1\\b_2\\b_3\end{array}\right.\right|=\begin{vmatrix}c_0&c_3&c_2&c_1\\c_1&c_0&c_3&c_2\\c_2&c_1&c_0&c_3\\c_3&c_2&c_1&c_0\end{vmatrix}\begin{vmatrix}a_0\\a_1\\a_2\\a_3\end{vmatrix}$$
$$\begin{aligned}&\text{字的}x\text{乘法:设}b(x)\text{是一个字,}\\&p(x)=xb(x)\mathrm{~mod~}x^4+1\\&\text{写成矩阵形式:}\\&\begin{pmatrix}p_0\\p_1\\p_2\\p_3\end{pmatrix}=\begin{pmatrix}00&00&00&01\\01&00&00&00\\00&01&00&00\\00&00&01&00\end{pmatrix}\begin{pmatrix}b_0\\b_1\\b_2\\b_3\end{pmatrix}\end{aligned}$$



### 逆元：
我们如果满足我们的域中的两个多项式相乘后等于我们的单位元 1，那么我们就把我们的一个多项式叫做另一个多项式的逆元。

在我们的 $GF(2^{8})$ 中，我们常用的不可约多项式为 $P(x)=x^{8}+x^{4}+x^{3}+x+1$。在这个多项式中，我们的对应逆元存在一个对应的报个，表示我们的某一个元素对应的逆元是什么，例如通过查表可知：
$x^{7}+x^{6}+x=(1100 0010)=(C_{2})$，我们就可以差我们的第 C 行第 2 列，查找我们的独影的逆元是什么如果得到的结果为 $2F$,那么我们的对应的系数就是 $x^{5}+x^{3}+x^{2}+x+1$。


## X 乘运算：
X 乘即在我们的多项式的两次，同时乘以个 $x$,我们可以证明，我们的广义乘法运算，可以通过 $X$ 乘运算和加法运算构造出来。

## 字运算：
AES 中使用 32bit 表示一个数据块，用一个字表示。一个字表示为系数取自 $GF(2^{8})$ 上的次数低于4次的多项式. 例如：
$$
\begin{align}
\text{0x57834AD1}\to57x^{3}+83x^{2}+4Ax+D_{1}
\end{align}
$$

### 字加法：
字多项式系数相加

### 字乘法：
$$\begin{aligned}&\text{字乘法:设}\mathbf{a}\text{和}\mathbf{b}\text{是两个字,}\mathbf{a}(\mathbf{x})=\mathbf{a}_3\mathbf{x}^3+\mathbf{a}_2\mathbf{x}^3+\mathbf{a}_1\mathbf{x}^3+\mathbf{a}_0\\&\text{与}\mathbf{b}(\mathbf{x})=\mathbf{b}_3\mathbf{x}^3+\mathbf{b}_2\mathbf{x}^3+\mathbf{b}_1\mathbf{x}^3+\mathbf{b}_0(\mathbf{x})\text{是其字多项式,}\end{aligned}$$

定义 a 和 b 的乘积为

$$\mathrm{c(x)=a(x)~b(x)~mod~x^4+1}$$
也可用矩阵表示为

$$\begin{gathered}\begin{pmatrix}c_0\\c_1\\c_2\\c_3\end{pmatrix}=\begin{pmatrix}a_0&a_3&a_2&a_1\\a_1&a_0&a_3&a_2\\a_2&a_1&a_0&a_3\\a_3&a_2&a_1&a_0\end{pmatrix}\begin{pmatrix}b_0\\b_1\\b_2\\b_3\end{pmatrix}\end{gathered}$$

## 总结：
对于我们的 $GF(2{^m})$ 的域，其中我们的 $m$ 表示我们的多项式的最大次数。我们上面的所有的元素都是一个多项式，斌给我们的多项式的系数只能为 $(0,1)$，域中包括我们的多项式加法（系数对应相加，取模），以及我们的多项式乘法（结果的系数要进行取模，斌给高次要通过不可约多项式化为低次多项式）。

