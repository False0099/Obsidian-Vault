数据认证算法是最为广泛使用的消息认证码中的一个已做为 FIPS Publication (FIPS PUB 113)并被 ANSI 作为X 9.17 标准。

算法基于 CBC 模式的 DES 算法，其初始向量取分零向量。需被认证的数据 (消息、记录、文件或程序)被分为 64 比特长的分组 $D_1,D_2,\cdots,D_N$ ,其中最后一个分组不够 64 比特的话,可在其右边填充一些 0，然后按以下过程计算数据认证码 (
看图 6-2):

$$\begin{aligned}&O_{1}=E_{K}(D_{1})\\&O_{3}=E_{K}(D_{2}\oplus O_{1})\\&O_{3}=E_{K}(D_{3}\oplus O_{2})\\&O_{N}=E_{K}(D_{N}\oplus O_{N-1})\end{aligned}$$
其中 E 为 DES 加密算法，K 为密钥。数据认证码或者取为为 O，或者
取为 $o$,的最左 M 个比特，其中 16 $\leq M\leq64$。

其实也就是基于 CBC 的加密
![[Pasted image 20241228155403.png]]
