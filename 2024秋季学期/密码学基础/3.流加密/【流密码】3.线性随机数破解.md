### 线性随机数破解
遗憾的是，我们的 PRNG 是不够安全的，我们可以通过**已知明文攻击**可以简单的算出我们的 $PRNG$ 的对应的所有的参数。我们首先定义一个 `PRNG` 如下：
$$S_{0}=seed$$

$$S_{i+1}\equiv(aS_{i}+b)\:mod\:m,i=0,1,2,\:.\:.\:.$$

其中，我们的 $m$ 是一个足够大的正数，并且是公开已知的，密钥包含（A, B）以及种子𝑆_0，每个值的长度均为 100 位。此时，密钥长度为 200 位，可以抵挡暴力攻击。

#### 例一：
我们如果想要解密我们的对应的随机数生成器，我们就需要**连续生成**的三个随机数和模数，也就是我们对于我们的对应的进行**三次运算得到的结果**。

我们于是可以构造出下面的一个方程组：
$$
\begin{align}
lg_{1}=(a\times lg_{0}+b) \text{ mod }m \\
lg_{2}=(a\times lg_{1}+b) \text{ mod }m
\end{align}
$$

我们对于我们的上面的同余方程，等式左右两边同时详见，我们就能得到：
$$
\begin{align}
lg_{2}-lg_{1}=(a\times(lg_{1}-lg_{0}))\text{ mod }m
\end{align}
$$

这个时候，加入我们的 $m$ 存在我们的逆元 $(lg_{1}-lg_{0})$，那么我们就直接左右两侧同时乘以我们的逆元即可得到我们的 a，得到了 a 之后，我们的 b 也可以很轻松就能得到。

#### 例二：
假设窃密者得到密文串 101101011110010 和相应的明文串 011001111111001，得密钥流为 110100100001011。进一步假定窃密者还知道密钥流是使用 5 级线性反馈移位寄存器产生的，那么窃密者可分别用密文串中的前 10 个比特和明文串中的前 10 个比特建立如下方程：

## 循环移位随机数破解：
只使用 LFSR 来产生密钥是非常不安全的。下文将在几种情况下说明 LFSR 的易攻破性。

LFSR 是线性关系，由其输入输出之间的线性关系来决定。然而在密码体制中，线性关系会使密钥变得非常不安全，**已知明文攻击**通过求解可以对其进行破译。假设攻击者已知一段长度为 2 m 的明文 $x_0,x_1,x_2,⋯,x_(2m-1)$，它对应的密文 $y_0,y_1,y_2,⋯y_(2m-1)$，此时攻击者可以重构开头的 2 m 个密钥序列：

$$s_i\equiv x_i+y_i\:mod\:2;i=0,1,2,\ldots,2m-1$$

由于每个 i 值都会生成不同的等式，因此我们可以得到 i 个等式：

$$
\begin{align}
i=0,\:s_{m}\equiv s_{m-1}p_{m-1}+\ldots+s_{1}p_{1}+s_{0}p_{0}\:mod2\\i=1,\:s_{m+1}\equiv s_{m}p_{m-1}+\ldots+s_{2}p_{1}+s_{1}p_{0}\:mod2\\i=2,\:s_{m+2}\equiv s_{m+1}p_{m-1}+\ldots+s_{3}p_{1}+s_{2}p_{0}\:mod2
\end{align}
$$
$\vdots$
$$i=m-1,\:s_{2m-2}p_{m-1}+\:..\:+s_{m}p_{1}+s_{m-1}p_{0}\:mod2$$

对于这个等式，可以使用高斯消去法、矩阵求逆或其他方法来求解此线性等式系统。即使 m 的值非常大，现代计算机仍然能够在较短时间计算求解。当然这并不代表 LFSR 无法应用到密码体系中去，我们可以通过使用多个 LFSR 进行组合，构建一个健壮的密码体制。


## 矩阵法破解：
已知一条 n 级 m 序列，如何求出产生这条 m 序列的 n 级线性反馈函数 (或递推关系)?
我们需要长为 2 n 的序列连续片段，不妨就设为前 2 n 个。设线性反馈函数为 $f(a_1,a_2,...,a_n)=c_na_1+c_{n-1}a_2+...+c_1a_n$,其中 $c_n$ 未知。因为 $a_{h+n}=c_1a_{h+n-1}+c_2a_{h+n-2}+...+c_na_h\left(h=1,2......n\right)$

$$\begin{aligned}&\text{写成矩阵形式就得到}\\&\begin{pmatrix}a_{n+1}&a_{n+2}&\cdots&a_{2n}\end{pmatrix}=\begin{pmatrix}c_n&c_{n-1}&\cdots&c_1\end{pmatrix}\begin{pmatrix}a_1&a_2&\cdots&a_n\\a_2&a_3&\cdots&a_{n+1}\\\cdots\\a_n&a_{n+1}&\cdots&a_{2n-1}\end{pmatrix}\\&=\begin{pmatrix}c_n&c_{n-1}&\cdots&c_1\end{pmatrix}X\end{aligned}$$



只要 $X$ 可逆，就能求出 $$\begin{pmatrix}c_n&c_{n-1}\cdots&c_1\end{pmatrix}=\begin{pmatrix}a_{n+1}&a_{n+2}\cdots&a_{2n}\end{pmatrix}X^{-1}$$



例如：同样度 m=4 
（1）反馈路径为 $(p_3=0,p_2=0,p_1=1,p_0=1)$ 的 LFSR，输出序列的周期为 $2^4-1=15$ 
（2）反馈路径为 $(p_3=1,p_2=1,p_1=1,p_0=1)$ 的 LFSR，输出序列的周期为 5
