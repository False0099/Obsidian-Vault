## 安全定义：
你比如说我们这个是消息的发送方，也就是我们刚才说的如果是凯撒密码，那就是凯撒，对不对？他要传递一条军事命令。好，发送方是 Alice，接收方就是 Bob。比如，如果是凯撒密码加密的话，要传递的真实情报，他的情报肯定是要传递给战场上的 Bob。那么他们就要在一个**不安全**的信道上传输信息。

既然是不安全的信道，肯定有人会去窃听。我们把这个坏蛋叫做奥斯卡，有的时候有的教材又把它叫做 Eve。他有访问权，但是不应该能够理解，就是说他**不应该能够理解通信的内容**。通信的本质就是应该是这样，只有 Alice 和 Bob 知道信息的保密通信的内容，不能让这个奥斯卡或者 Eve 知道这个消息的内容。

## 加密定义：
Alice 呢他要发送的那个明文，我们叫 X。密文记作 Y。然后，你看我们这个这个 X 明文。他们帮。有一个加密盒子或者一个加密函数叫做 E，E 函数有两个输入，比如说他我们学过高等数学，我们可以把那是个二元函数，不对，就两个输入法，一个是明文，一个是加密的 key 是吧，这个是密钥 K，然后呢，经过这个加密以后，是不是就等于 Y 这个地方我们是不是就可以用一个函数表达式来写表达它了，这个密钥对明文进行加密，就把密文 Y 了，好，这个密文 Y 呢，就可以在这个不安全的信道上传输了。

它就是这个原理，我们都可以用，待会儿我们再理解一些古典密码之后，我们还要回过来用这个概念模型去理解一些古典密码。

## 密钥空间：
好，当中还有一个重要的概念就是，老师有一个密钥空间的概念，对不对，你这有个密钥空间。比如说我这个密钥空间当中有 N 个密，一般来说我们在加密的时候，会从这个空间当中去随机的选取某一个密钥。

大家从直觉上来讲，这个密钥空间是不是要足够大。只要我这个密钥空间足够大，所以我们的一些基本的感性都会觉得应该是这样。

经过这个加密变换，只要我这个加密算法。那么只要奥斯卡不知道这个密钥，那么他如果他仅仅获得密文 Y，那对他来说密 Y 就是一个随机比特流。这随机。每一个比特就这样子，实际的比值怎么去理解？同学们，这告诉飞机的比头位串或者随机的比位串，我们怎么去理解它什么是？回传最好的理解方式，Random。

所以说对于奥斯卡而言，他到的 Y 就是这样的一个随机比特对于他而言就是。猜不到也不能获取的任何从 Y 当中获取任何 X 明文 X 的任何信息。

## 一致性：
既然如果你是一个正确的加密加密。不是，应该要满足以下这样的一个，叫做一致性或者正确性。就是我用同一个密钥加密以后的，这是这个里边是不是就是 Y，我用同一个密钥加密的明文，你能够用同一个密钥解密出来是吧？这个是证据性的，基本的证据性要求，这个地方是不是就是我们的 Y。对。这就是我们的密文了，是啊。就是说你用同一个密钥加密的。以后的得到的这个密文，我用同一个密钥去解密它，这两个密钥是一样的。O 是一个 K。好，是不是，那么我用同一密钥加密的明文，我可以用同一个密钥。把这个明文解密出来嘛，所以就是一致性。

我们也把它正正确性反过来，或者说按照教材费用说法，我们说加减密是一个负逆的变换，是不是是封闭的。异变加米是密的。逆势经济的逆变换，逆运算，逆互逆的嘛。这两个运算，对不对，这两种运算它是互利互利的。加密式解密的逆运算，解密式加密能力运算是。Inverse inverse vere，可疑，Need。运算对不对。如果说他前提上是，如果这个你在这两次的运算过程当中使用的都是同一个题是吧。在这两边你都是在加密的时候，你是要同一同一个解密之后也要用同一个，那一定能够满足这个等式，对，所以我们也上，我们也把它叫做加密算法的正确性。

## 安全信道：
那么这个地方，那么有一个刚才我们也提的这个我们的概念模型当中也画出来了，他说。密钥你一定先要通过一个**安全的信道传输**了。

这个密钥必须在 Alice 和 Bob 之间分发好。对于安全信道的设置，有多种方法，比如说这个教材这个地方提到了，他是说，我直接他这个地方涉及到的是硬件设备。硬件设备，比如说我们的无线 WiFi，我们的路由器的路由器，我在出厂的时候，我就动的向路由器安装了这个密钥了。对。然后同时呢，我在我的这个电脑设备上也安装了一个密钥，同样的密钥，那我这个手机跟路由器之间就可以进行保密通信，那这个他写的不是特别明确的一个含义，另外呢，比如说现实，比如说我们的军事环境当中呢，我们可以用一个。这个邮差，密钥，我们到底在保密通信之前，这个密钥对称密钥怎么分呢？是后面我们要解决的问题。现在我们暂且家庭。我们在保密通信之前，Alice 和 Bob 之间就已经共享了同样一个。神喵。好，这个是那么通过，那么特别，我们待会儿还要讲一个 coco 准则，他就说了这个保密通信，

于是，整个的加密的安全性或者保密通信的安全性，就归约到密钥，一个短小的**密钥的安全性**。所以我们要我们总结的话，这个这一句话怎么说呢，就是。安全传输这个问题保存这个密钥。

我们再回到现实当中，用这个概念模型来指导我们理解一些具体的密码算法，比如说我们下面要讲的，这就是一个人类最容易想到，也是最简单的一个密码算法，我们把它要做替代一码。对。

替代 substitution 嘛，替换的意思嘛？好，我们来看一看这个密码就很简单，我们来看一看 T 带。或者替换都可以，你这个怎么两种翻译都可以替代密码，替换密码。你看这个替换密码，它是属于古典密码，就是古典的或者历史的。我们的历史的或者古典的密码，所以它处理的这个**信息单元是字母**，看见没有。这对于我们。非常非常好的一个例子，我们就从这个。第一代密码开始。这个密码很简单，你看比如说这个地方就是大写字母，就是我们的明文，在我们的教材当中，他约定俗成，大写字母呢，就是我们的明文。我们约定写小写字母呢，就是密文，

比如说你看我现在要进行我它的原理就是把每一个明文的字母。把它替换成一个。其他的一个字母，好，那么按照刚才我们的这个这个概念模型的理解，是不是这个明文密文都有了，那我们的密钥是什么？大家想一下密钥是什么，密钥是不是就是这个，映射表。这表就就是我们的密钥，是不是。这个就是我们的映射表嘛。

好，那么我们现在是说，老师那这个好多的这些古典密码，实际上它**本质上就是替代密码**，比如说我们前面讲过的这些都是替代密码。

这样你就可以理解。这个这些后面我们会讲德军的一定格玛密码机，这些更是它也是它。复杂一些的一个**替代密码**。好，所以你看我们现在回过来，再回到我们的替代密码，那替代密码，老师，我这个替代密码是不是就安全了呢。比如说我们为了达到它安全，我们还有一个要求，我们说老师每一次加密的时候，你要加密一些信息的，加密一个信息的时候，我们都随机生成这个映射表。是吧，随机来生成这个隐射表证因为你前面不是讲了吗，密钥要随机的选择，满足你这个原则，那我贴在密码当中，我就是我每一次加密的消消息的时候，我就**随机生成一个映射表**。是不是这可以随机生产影射标，那这样就足够安全，那我们看如果是做了这样一些要求以后，我们的替代密码是不是它就真的安全呢？

## 安全性分析：
### 蛮力攻击法
是不是它就生产安全了？好，下面我们就来考虑它的安全性，替代密码的安全性。好，那么替代密码，实际上对于每一种密码算法，我们都有一种攻击，叫做蛮力攻击，或者是密钥的穷搜索攻击。

Exhausive，穷尽的穷的精力都耗尽了的，Exhausting。要求假设一手攻击者。他掌握了一个名密文，对，说明文是 X ，密文是 Y ，待会我们在这个约定再稍微说一下，有的时候我还不需要知道密文，但是我们现在先假定他知道一个明密文。假定啊，我们说这个这个 X 零对应的密码是 Y 零，那我就是搜索这个密钥空间当中所有的密。尝试来解密这个 Y 零，看能不能把 X 零恢复出来，对不对？我把这个密钥空间中一个一个的庙拿来尝试。一直尝试我用 K 一来解密 Y 零，看能不能把 X 零恢复出来，恢复不出来没办法，

### 频率分析：
在实际的密码破译过程中，我们不仅仅可以利用单字母的出现频率，还可以利用双字母的组合频率。例如，在某些文本中，出现频率最高的双字母组合可能是“TH”或“HE”等。此外，我们还可以分析三字母组合的频率，例如“THE”或“AND”等。这些频率分析的方法可以帮助我们更快地破译密码。

以替代加密为例，这种加密方式相对容易被破解。如果感兴趣的同学可以尝试编写一个程序，利用频率分析的方法来破译替代加密的密文。通过这种方式，我们可以更好地理解密码的安全性。

在设计密码系统时，我们需要考虑其是否能够抵御各种攻击。即使替代加密的密钥空间很大，它仍然容易被频率分析等方法破解。因此，一个加密方案必须能够经受住所有类型的攻击，才能被认为是安全的。

然而，我们无法穷尽所有的攻击手段。未来可能会有新的攻击方法被提出，因此我们不能轻易断言某个加密方案是绝对安全的。通常，一个加密方案需要经过大量的密码分析，确保在几十年内都无法找到漏洞，才能被认为是可靠的。

例如，AES 算法在过去的二十多年中一直未被有效破解，因此我们可以假设它能够抵御大多数攻击。接下来，我们将介绍密码分析的基本概念。

## 密码分析：
密码分析是密码学的一个重要分支，它致力于破译密码系统。没有密码分析，我们无法评估密码系统的安全性。只有当大量的密码分析专家都无法找到有效的攻击手段时，我们才能认为该密码系统是安全的。

在介绍密码分析的具体内容之前，我们先来看一个经典的密码学原则：Kerckhoffs 原则。该原则指出，一个**密码系统的安全性应当完全依赖于密钥的保密性**，而不是算法的保密性。即使攻击者知道系统的所有细节，只要密钥保密，系统就应当是安全的。

这一原则在现代密码学中得到了广泛应用。因此，我们在设计密码系统时，应当使用经过大量分析和验证的标准算法，而不是私有的、未经充分测试的算法。历史上，许多私有的加密算法在提出后不久就被破解，例如早期的 CSS 加密标准。

接下来，我们将密码算法分为几大类。第一类是古典密码，包括凯撒密码、维吉尼亚密码等。这些密码通常基于简单的替换或移位操作，容易被频率分析等方法破解。第二类是基于数学的密码分析，例如使用统计方法分析字母频率。第三类是基于实现的攻击，例如通过逆向工程或侧信道攻击提取密钥。侧信道攻击是通过分析加密过程中的能量消耗、电磁辐射等信息来获取密钥。此外，还有社会工程学攻击，即通过欺骗手段获取用户的密钥或密码。例如，攻击者可能伪装成银行工作人员，诱骗用户提供账户信息。

在密码分析中，攻击者掌握的信息越多，破解密码的概率就越高。根据攻击者掌握的信息，密码分析可以分为以下几类：

1. **唯密文攻击**：攻击者只知道密文，试图通过分析密文来推断明文或密钥。
2. **已知明文攻击**：攻击者知道一些明文和对应的密文，试图通过这些信息推断密钥。
3. **选择明文攻击**：攻击者可以选择特定的明文并获取对应的密文，试图通过这些信息推断密钥。
4. **选择密文攻击**：攻击者可以选择特定的密文并获取对应的明文，试图通过这些信息推断密钥。

## 群论环
在数学中，我们经常需要通过约简来简化中间结果。例如，81 可以约简为 9。尽可能早地进行约简是有益的，因为化简后的结果越小，计算起来越方便。接下来，我们将继续介绍这一部分的最后一个重要概念——**整数环**。

整数环是线性代数中的一个重要概念，尤其在抽象代数中占有重要地位。我不知道大家是否已经学习过线性代数，或者在线性代数中是否已经接触过一些抽象代数的概念。无论如何，在这里我们将涉及到一个所谓的**整数环**。

在数学中，有一些重要的代数结构，我们称之为**群**、**环**、**域**等。这些代数结构在数学中扮演着非常重要的角色。今天，我们将重点介绍**环**这一结构。

首先，我们需要明确一些记号。在数学中，我们通常用 $Z$ 来表示所有整数的集合。如果在 $Z$ 上加一个下标 $M$，即 $Z_M$，则表示模 $M$ 的整数集合。换句话说，$Z_M$ 中的元素是通过模 $M$ 约简后的整数，其取值范围为 $0$ 到 $M-1$。这个集合在密码学中非常有用，因为我们可以在这个有限的离散集合上定义模加法和模乘法运算。

具体来说，$Z_M$ 中的元素是从 $0$ 到 $M-1$ 的整数集合。我们可以在这个集合上定义模加法和模乘法运算，这些运算满足环的性质。因此，$Z_M$ 被称为**整数环**。为了强调运算，我们可以将整数环表示为 $(Z, +, \times)$，其中 $+$ 表示模加法，$\times$ 表示模乘法。

要构成一个环，运算必须满足以下条件：
1. **封闭性**：对于 $Z_M$ 中的任意两个元素，进行模加法或模乘法运算后，结果仍然在 $Z_M$ 中。
2. **结合律**：模加法和模乘法都满足结合律，即 $(a + b) + c = a + (b + c)$，$(a \times b) \times c = a \times (b \times c)$。
3. **交换律**：模加法满足交换律，即 $a + b = b + a$。
4. **分配律**：模乘法对模加法满足分配律，即 $a \times (b + c) = (a \times b) + (a \times c)$。
5. **加法单位元**：存在一个元素 $0$，使得对于任意 $a \in Z_M$，$a + 0 = a$。
6. **加法逆元**：对于任意 $a \in Z_M$，存在一个元素 $-a$，使得 $a + (-a) = 0$。
7. **乘法单位元**：存在一个元素 $1$，使得对于任意 $a \in Z_M$，$a \times 1 = a$。
8. **乘法逆元**：对于 $Z_M$ 中的某些元素，存在乘法逆元。具体来说，只有当 $a$ 与 $M$ 互质时，$a$ 才存在乘法逆元。

满足以上条件的 $Z_M$ 称为**整数环**。整数环的一个重要特点是，我们可以在其中进行模加法、模减法和模乘法运算，但模除法运算仅对某些元素有效，即那些与 $M$ 互质的元素。

例如，在 $Z_9$ 中，元素 $0$、$3$、$6$ 没有乘法逆元，因为它们与 $9$ 不互质。而元素 $1$、$2$、$4$、$5$、$7$、$8$ 则存在乘法逆元。因此，我们只能在 $Z_9$ 中对这些元素进行模除法运算。

整数环的概念在密码学中有广泛应用，尤其是在对称密码和公钥密码中。例如，凯撒密码和维吉尼亚密码都可以通过模运算来简洁地表达。凯撒密码是一种移位密码，通过将字母表中的字母向后移动固定的位数来加密。维吉尼亚密码则是一种多字母替代密码，通过使用一个密钥字符串来对明文进行加密。

---

### 凯撒密码与模运算

凯撒密码是一种非常简单的加密方法，它通过将字母表中的字母向后移动固定的位数来加密。例如，如果我们将字母 $A$ 向后移动 $3$ 位，它将变成 $D$。这种加密方法可以通过模运算来简洁地表达。

假设我们有一个字母表，包含 $26$ 个字母（$A$ 到 $Z$）。我们可以将每个字母对应到一个整数，$A$ 对应 $0$，$B$ 对应 $1$，依此类推，$Z$ 对应 $25$。如果我们使用凯撒密码，将字母向后移动 $k$ 位，那么加密过程可以表示为：

$$
C = (P + k) \mod 26
$$

其中，$P$ 是明文字母对应的整数，$C$ 是密文字母对应的整数，$k$ 是移位的位数。

例如，如果我们要加密字母 $A$（对应 $0$），并且 $k=3$，那么：

$$
C = (0 + 3) \mod 26 = 3
$$

对应的密文字母是 $D$。

解密过程则是：

$$
P = (C - k) \mod 26
$$

通过这种方式，我们可以用模运算来简洁地表达凯撒密码的加密和解密过程。

---

### 维吉尼亚密码与模运算

维吉尼亚密码是一种多字母替代密码，它通过使用一个密钥字符串来对明文进行加密。与凯撒密码不同，维吉尼亚密码的密钥是一个字符串，而不是一个固定的移位位数。

假设我们有一个密钥 $KEY$，长度为 $n$。我们将密钥重复使用，直到它的长度与明文相同。然后，我们将每个明文字母与对应的密钥字母相加，再进行模 $26$ 运算，得到密文字母。

例如，如果我们要加密明文 $ATTACK$，密钥为 $KEY$，那么加密过程如下：

1. 将明文和密钥转换为对应的整数：
   - $A=0$, $T=19$, $T=19$, $A=0$, $C=2$, $K=10$
   - $K=10$, $E=4$, $Y=24$, $K=10$, $E=4$, $Y=24$

2. 对每个明文字母和密钥字母进行模加法运算：
   - $(0 + 10) \mod 26 = 10$ → $K$
   - $(19 + 4) \mod 26 = 23$ → $X$
   - $(19 + 24) \mod 26 = 17$ → $R$
   - $(0 + 10) \mod 26 = 10$ → $K$
   - $(2 + 4) \mod 26 = 6$ → $G$
   - $(10 + 24) \mod 26 = 8$ → $I$

因此，密文为 $KXRKGI$。

通过这种方式，我们可以用模运算来简洁地表达维吉尼亚密码的加密过程。

---

### 仿射密码与模运算

仿射密码是一种更为复杂的加密方法，它结合了模加法和模乘法运算。仿射密码的加密过程可以表示为：

$$
C = (a \times P + b) \mod 26
$$

其中，$P$ 是明文字母对应的整数，$C$ 是密文字母对应的整数，$a$ 和 $b$ 是密钥。

为了能够解密，$a$ 必须与 $26$ 互质，即 $a$ 必须存在乘法逆元。解密过程则是：

$$
P = a^{-1} \times (C - b) \mod 26
$$

其中，$a^{-1}$ 是 $a$ 的乘法逆元。

例如，如果我们选择 $a=5$，$b=8$，那么加密字母 $A$（对应 $0$）的过程如下：

$$
C = (5 \times 0 + 8) \mod 26 = 8
$$

对应的密文字母是 $I$。

解密过程则是：

$$
P = 5^{-1} \times (8 - 8) \mod 26 = 0
$$

对应的明文字母是 $A$。

通过这种方式，我们可以用模运算来简洁地表达仿射密码的加密和解密过程。

整数环是数学中一个非常重要的代数结构，它在密码学中的应用尤为广泛。通过理解整数环的性质，我们可以更好地理解和设计各种加密算法，如凯撒密码、维吉尼亚密码和仿射密码。这些加密方法都可以通过模运算来简洁地表达，从而使得加密和解密过程更加高效和易于理解。
